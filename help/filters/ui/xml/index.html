<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Filters - XML Filter</title>
<link rel="stylesheet" type="text/css" href="../../../help.css">
</head>
<body>

<table border="0" width="100%" cellspacing="0" cellpadding="0">
	<tr class="head">
		<td class="head" colspan="2"><h1 class="head">Okapi Framework - Filters</h1>
		<h2 class="head2">XML Filter (BETA)</h2></td>
	</tr>
	<tr>
		<td class="smalltoc"><p>
			- <a href="#overview">Overview</a><br>
			- <a href="#itsSupport">ITS Support</a><br>
			- <a href="#itsExtensions">ITS Extensions</a><br>
			- <a href="#processing">Processing Details</a><br>
			- <a href="#parameters">Parameters</a><td class="hmenu">
			<div class="hmenu"><table align="right"><tr>
				<td><a href="../index.html">Filters</a></td>
				<td><a href="http://okapi.opentag.com/devguide/index.html">Developer&#39;s Guide</a></td>
				<td><a href="http://okapi.opentag.com">Okapi Framework</a></td>
			</tr></table></div>
		</td>
	</tr>
</table>

<h2><a name="overview"></a>Overview</h2>
<p>This filter allows you to process XML documents.</p>

<p>The following is an example of a simple XML document. The translatable text 
is underlined. Because each format based on XML is different, you need 
information on what are the translatable parts, what are the inline elements, 
etc. The XML Filter <a href="#itsSupport">implements the ITS W3C Recommendation</a> 
to address this issue.</p>
<pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;myDoc&gt;
 &lt;prolog&gt;
  &lt;author&gt;Zebulon Fairfield&lt;/author&gt;
  &lt;version&gt;version 12, revision 2 - 2006-08-14&lt;/version&gt;
  &lt;keywords&gt;&lt;kw&gt;<u>horse</u>&lt;/kw&gt;&lt;kw&gt;<u>appaloosa</u>&lt;/kw&gt;&lt;/keywords&gt;
  &lt;storageKey&gt;articles-6D272BA9-3B89CAD8&lt;/storageKey&gt;
 &lt;/prolog&gt;
 &lt;body&gt;
  &lt;title&gt;<u>Appaloosa</u>&lt;/title&gt;
  &lt;p&gt;<u>The Appaloosas are rugged horses originally breed by 
the </u>&lt;kw&gt;<u>Nez-Perce</u>&lt;/kw&gt;<u> tribe in the US Northwest.</u>&lt;/p&gt;
  &lt;p&gt;<u>They are often characterized by their spotted coats.</u>&lt;/p&gt;
 &lt;/body&gt;
&lt;/myDoc&gt;</pre>
<p>This filter is implement in the class <code>
net.sf.okapi.filters.xml.XMLFilter</code> of the Okapi library.</p>
<h2><a name="itsSupport"></a>ITS Support</h2>
<p>The <b>Internationalization Tag set (ITS )</b> is a W3C recommendation that 
defines a set of elements and attributes you can use to specify different 
internationalization- and localization-related aspects of your XML document, for 
instance: define what attribute values are translatable, what element content 
should be protected, what element should be treated as a nested sub-flow of 
text, and much more.</p>
<p>The ITS specification is available at <a href="http://www.w3.org/TR/its/">
http://www.w3.org/TR/its/</a>.</p>
<p>By default the filter process the XML documents based on the ITS defaults. 
That is: the content of all elements is translatable, and none of the values of 
the attribute are. To modify this behavior you need to associate the document 
with ITS rules. This can be done different ways:</p>
<ul>
	<li>By including global and local rules inside the document.</li>
	<li>By including inside the document a link to external global rules.</li>
	<li>By associating the document with a parameters file when running the 
	filter. The parameter file being a set of external ITS global rules.</li>
</ul>

<p>When processing a document, the filter...</p>
<ol>
	<li>Assumes that all element content is translatable, and none of the 
	attribute values are translatable.</li>
	<li>Applies the global rules found in the (optional) parameters file 
	associated with the input document.</li>
	<li>Applies the global rules found in the document.</li>
	<li>And finally, applies the local rules within the document. </li>
</ol>
<p>For example, assuming that <code>ITSForDoc.xml</code> is the ITS file 
associated with the input file <code>Document.xml</code>, the translatable text 
is listed below.</p>
<p>ITSForDoc.xml:</p>
<pre>&lt;its:rules xmlns:its=&quot;http://www.w3.org/2005/11/its&quot; version=&quot;1.0&quot;&gt;
 &lt;its:translateRule selector=&quot;//head&quot; translate=&quot;no&quot;/&gt;
 &lt;its:withinTextRule selector=&quot;//b|//code|//img&quot; withinText=&quot;yes&quot;/&gt;
&lt;/its:rules&gt;</pre>
<p>Document.xml:</p>
<pre>&lt;doc&gt;
 &lt;head&gt;
  &lt;update&gt;2009-03-21&lt;/update&gt;
  &lt;author&gt;Mirabelle McIntosh&lt;/author&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;p&gt;Paragraph with &lt;img ref=&quot;eg.png&quot;/&gt; and &lt;b&gt;bolded text&lt;/b&gt;.&lt;/p&gt;
  &lt;p&gt;Paragraph with &lt;code&gt;data codes&lt;/code&gt; and text.&lt;/p&gt;
 &lt;/body&gt;
&lt;/doc&gt;</pre>
<p>The resulting text units are (in XLIFF 1.2 notation):</p>
<pre>1: &quot;Paragraph with &lt;x id=&#39;1&#39;&gt; and &lt;g id=&#39;2&#39;&gt;bolded text&lt;/g&gt;.&quot;
2: &quot;Paragraph with &lt;g id=&#39;1&#39;&gt;&lt;x id=&#39;2&#39;/&gt;&lt;/g&gt; and text.&quot;</pre>
<h2><a name="itsExtensions"></a>ITS Extensions</h2>
<p>The filter supports extensions to the ITS specification. These extension use 
the namespace URI <code>http://www.w3.org/2008/12/its-extensions</code>.</p>
<h3>idPointer and xml:id</h3>
<p>When the attribute <code>xml:id</code> is found on a translatable element, it 
is used as the name of the text unit generated for that element.</p>
<p>For example, in the example below, the resource name associated with the text 
unit for the <code>&lt;p&gt;</code> element is &quot;<code>id1</code>&quot;.</p>
<pre>&lt;p xml:id=&quot;id1&quot;&gt;Text&lt;/p&gt;</pre>
<p>The attribute <code>idPointer</code> used in the ITS <code>translateRule</code> 
element allows you to define an XPath expression--relative to the selection for 
that element-- pointing to the node that holds the identifier value for the 
given selection.</p>
<p>For example, in the example below, the resource name associated with the text 
unit for the <code>&lt;p&gt;</code> element is &quot;<code>id1</code>&quot;.</p>
<pre>&lt;doc&gt;
 &lt;its:rules version=&quot;1.0&quot; xmlns:its=&quot;http://www.w3.org/2005/11/its&quot;
  xmlns:itsx=&quot;http://www.w3.org/2008/12/its-extensions&quot;&gt;
  &lt;its:translateRule selector=&quot;//p&quot; translate=&quot;yes&quot; itsx:idPointer=&quot;@name&quot;/&gt;
 &lt;/its:rules&gt;
 &lt;p name=\&quot;id1\&quot;&gt;text 1&lt;/p&gt;
&lt;/doc&gt;</pre>
<p>Note that <code>xml:id</code> has precedence over <code>idPointer</code> 
declaration. For example, in the example below, the resource name associated 
with the text unit for the <code>&lt;p&gt;</code> element is &quot;<code>xid1</code>&quot;, not 
&quot;<code>id1</code>&quot;.</p>
<pre>&lt;doc&gt;
 &lt;its:rules version=&quot;1.0&quot; xmlns:its=&quot;http://www.w3.org/2005/11/its&quot;
  xmlns:itsx=&quot;http://www.w3.org/2008/12/its-extensions&quot;&gt;
  &lt;its:translateRule selector=&quot;//p&quot; translate=&quot;yes&quot; itsx:idPointer=&quot;@name&quot;/&gt;
 &lt;/its:rules&gt;
 &lt;p xml:id=&quot;xid1&quot; name=\&quot;id1\&quot;&gt;text 1&lt;/p&gt;
&lt;/doc&gt;</pre>
<h2><a name="processing"></a>Processing Details</h2>
<h3>Input Encoding</h3>
<p>The filter decides which encoding to use for the input document using the 
following logic:</p>
<ul>
	<li>If the document has an encoding declaration it is used.</li>
	<li>Otherwise, UTF-8 is used as the default encoding (regardless the actual 
	default encoding that was specified when opening the document).</li>
</ul>
<h3>Output Encoding</h3>
<p>If the output encoding is UTF-8:</p>
<ul>
	<li>If the input encoding was also UTF-8, a Byte-Order-Mark is used for the 
	output document only if one was detected in the input document.</li>
	<li>If the input encoding was not UTF-8, no Byte-Order-Mark is used in the 
	output document.</li>
</ul>
<p>If the original document had an XML encoding declaration it is updated, if it 
did not, one is automatically added.</p>
<h3>Line-Breaks</h3>
<p>The type of line-breaks of the output is the same as the one of the original 
input.</p>

<h2><a name="parameters"></a>Parameters</h2>
<p>The parameters for the XML filter are stored in an ITS document.</p>
<p>&nbsp;</p>

</body>
</html>